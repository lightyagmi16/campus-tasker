(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{1042:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});var a=t(5155),n=t(2115),r=t(5695),i=t(3233);function l(e){let{children:s}=e,t=(0,r.useRouter)(),[l,c]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{let e=!0;i.N.auth.getSession().then(s=>{let{data:a}=s;e&&(a.session?c(!0):t.replace("/login"))});let{data:s}=i.N.auth.onAuthStateChange((e,s)=>{s?c(!0):t.replace("/login")});return()=>{e=!1;try{s.subscription.unsubscribe()}catch(e){}}},[t]),l)?(0,a.jsx)("div",{className:"container-app",children:s}):(0,a.jsx)("div",{className:"container-app p-6",children:"Loadingâ€¦"})}},3233:(e,s,t)=>{"use strict";t.d(s,{N:()=>a});let a=(0,t(2354).UU)("https://ixrecmfguwautitoatcc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml4cmVjbWZndXdhdXRpdG9hdGNjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUwOTUxODMsImV4cCI6MjA3MDY3MTE4M30.ImkR-P4lGGIR0_e31Fu6tGLGM1DPE-15mcN-Q9iFR1w",{auth:{persistSession:!0,autoRefreshToken:!0}})},6431:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(5155),n=t(2115),r=t(5695),i=t(3233),l=t(1042),c=t(7605),u=t(7799);function d(){let{taskId:e}=(0,r.useParams)(),[s,t]=(0,n.useState)([]),[d,o]=(0,n.useState)(""),[m,h]=(0,n.useState)(null);async function x(){if(!d.trim())return;let{data:s}=await i.N.auth.getUser();await i.N.from("task_messages").insert({task_id:Number(e),sender:s.user.id,message:d.trim()}),o("")}return(0,n.useEffect)(()=>{i.N.auth.getUser().then(e=>{let{data:s}=e;return h(s.user||null)}),(async()=>{let{data:s}=await i.N.from("task_messages").select("*").eq("task_id",e).order("created_at");t(s||[])})();let s=i.N.channel("chat-".concat(e)).on("postgres_changes",{event:"INSERT",schema:"public",table:"task_messages",filter:"task_id=eq.".concat(e)},e=>t(s=>[...s,e.new])).subscribe();return()=>{i.N.removeChannel(s)}},[e]),(0,a.jsxs)(l.A,{children:[(0,a.jsx)(c.A,{title:"Chat"}),(0,a.jsx)("div",{className:"px-4 pt-3 pb-24 min-h-screen",children:(0,a.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,a.jsx)("div",{className:"max-w-[75%] px-3 py-2 rounded-2xl ".concat(e.sender===(null==m?void 0:m.id)?"bg-blue-600 text-white ml-auto":"bg-gray-100"),children:e.message},e.id))})}),(0,a.jsx)("div",{className:"bottom-nav border-t",children:(0,a.jsxs)("div",{className:"max-w-[480px] mx-auto p-3 flex gap-2",children:[(0,a.jsx)("input",{className:"border rounded-lg px-3 py-2 flex-1",value:d,onChange:e=>o(e.target.value),placeholder:"Type a message..."}),(0,a.jsx)("button",{className:"px-4 py-2 rounded-lg bg-blue-600 text-white",onClick:x,children:"Send"})]})}),(0,a.jsx)(u.A,{})]})}},7605:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var a=t(5155),n=t(6874),r=t.n(n);function i(e){let{title:s="Campus Tasker"}=e;return(0,a.jsx)("div",{className:"header",children:(0,a.jsx)("div",{className:"max-w-[480px] mx-auto px-4 py-3 flex items-center justify-between",children:(0,a.jsx)(r(),{href:"/",className:"font-semibold",children:s})})})}},7799:(e,s,t)=>{"use strict";t.d(s,{A:()=>m});var a=t(5155),n=t(6874),r=t.n(n),i=t(5695),l=t(7340),c=t(1497),u=t(4186),d=t(1007);let o=[{href:"/",label:"Feed",icon:l.A},{href:"/chat",label:"Chats",icon:c.A},{href:"/history",label:"History",icon:u.A},{href:"/profile",label:"Profile",icon:d.A}];function m(){let e=(0,i.usePathname)();return(0,a.jsx)("nav",{className:"bottom-nav",children:(0,a.jsx)("div",{className:"max-w-[480px] mx-auto grid grid-cols-4 text-sm",children:o.map(s=>{let{href:t,label:n,icon:i}=s;return(0,a.jsxs)(r(),{href:t,className:"flex flex-col items-center justify-center py-2 ".concat(e===t?"text-black":"text-gray-500"),children:[(0,a.jsx)(i,{size:20}),(0,a.jsx)("span",{className:"text-[11px] mt-0.5",children:n})]},t)})})})}},8099:(e,s,t)=>{Promise.resolve().then(t.bind(t,6431))}},e=>{e.O(0,[354,134,441,964,358],()=>e(e.s=8099)),_N_E=e.O()}]);